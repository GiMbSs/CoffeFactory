<!-- Sidebar -->
<nav class="bg-white dark:bg-gray-900 w-64 min-h-screen border-r border-coffee-200 dark:border-coffee-700 transform transition-transform duration-300 ease-in-out lg:translate-x-0 fixed lg:static inset-y-0 left-0 z-40"
     :class="{ 'translate-x-0': sidebarOpen, '-translate-x-full': !sidebarOpen }"
     x-data="{ activeMenu: '{{ request.resolver_match.app_name }}' }">
     
    <!-- Logo/Brand -->
    <div class="flex items-center justify-between px-4 py-6 border-b border-coffee-200 dark:border-coffee-700">
        <div class="flex items-center space-x-3">
            <div class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-coffee-500 to-coffee-700 rounded-lg flex items-center justify-center">
                <i class="fas fa-coffee text-white text-xl"></i>
            </div>
            <div>
                <h1 class="text-xl font-bold text-coffee-900 dark:text-white">Coffee Factory</h1>
                <p class="text-xs text-coffee-500 dark:text-coffee-400">Management System</p>
            </div>
        </div>
        <!-- Mobile close button -->
        <button @click="sidebarOpen = false" class="lg:hidden p-2 rounded-md text-coffee-400 hover:text-coffee-600 dark:hover:text-coffee-300">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- User Info -->
    {% if user.is_authenticated %}
    <div class="px-4 py-4 border-b border-coffee-200 dark:border-coffee-700">
        <div class="flex items-center space-x-3">
            <div class="flex-shrink-0 w-10 h-10 bg-coffee-100 dark:bg-coffee-900 rounded-full flex items-center justify-center">
                {% if user.first_name %}
                    <span class="text-coffee-600 dark:text-coffee-400 font-semibold">
                        {{ user.first_name|first|upper }}{{ user.last_name|first|upper }}
                    </span>
                {% else %}
                    <i class="fas fa-user text-coffee-600 dark:text-coffee-400"></i>
                {% endif %}
            </div>
            <div class="flex-1 min-w-0">
                <p class="text-sm font-medium text-coffee-900 dark:text-white truncate">
                    {% if user.first_name %}{{ user.first_name }} {{ user.last_name }}{% else %}{{ user.username }}{% endif %}
                </p>
                <p class="text-xs text-coffee-500 dark:text-coffee-400 truncate">
                    {% if user.role %}{{ user.get_role_display }}{% else %}Usuário{% endif %}
                </p>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Navigation Menu -->
    <div class="px-2 py-4 space-y-1">
        
        <!-- Dashboard -->
        <a href="{% url 'core:dashboard' %}" 
           class="group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 hover:bg-coffee-100 dark:hover:bg-coffee-800"
           :class="{ 'bg-coffee-50 dark:bg-coffee-900/20 text-coffee-700 dark:text-coffee-400 border-r-2 border-coffee-500': activeMenu === 'core' || '{{ request.resolver_match.url_name }}' === 'dashboard', 'text-coffee-700 dark:text-coffee-300': activeMenu !== 'core' && '{{ request.resolver_match.url_name }}' !== 'dashboard' }">>
            <i class="fas fa-tachometer-alt mr-3 w-5 text-center group-hover:scale-110 transition-transform"></i>
            Dashboard
        </a>

        <!-- Accounts/Funcionários -->
        <div x-data="{ open: activeMenu === 'accounts' }">
            <button @click="open = !open" 
                    class="group w-full flex items-center justify-between px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 hover:bg-coffee-100 dark:hover:bg-coffee-800"
                    :class="{ 'bg-coffee-50 dark:bg-coffee-900/20 text-coffee-700 dark:text-coffee-400': open, 'text-coffee-700 dark:text-coffee-300': !open }">
                <div class="flex items-center">
                    <i class="fas fa-users mr-3 w-5 text-center group-hover:scale-110 transition-transform"></i>
                    Funcionários
                </div>
                <i class="fas fa-chevron-down transform transition-transform duration-200" :class="{ 'rotate-180': open }"></i>
            </button>
            <div x-show="open" x-collapse class="ml-6 mt-1 space-y-1">
                <a href="{% url 'accounts:employee_list' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-list mr-2"></i>Lista de Funcionários
                </a>
                {% if user.is_staff %}
                <a href="{% url 'accounts:employee_create' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-plus mr-2"></i>Novo Funcionário
                </a>
                {% endif %}
            </div>
        </div>

        <!-- Inventory -->
        <div x-data="{ open: activeMenu === 'inventory' }">
            <button @click="open = !open" 
                    class="group w-full flex items-center justify-between px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 hover:bg-coffee-100 dark:hover:bg-coffee-800"
                    :class="{ 'bg-coffee-50 dark:bg-coffee-900/20 text-coffee-700 dark:text-coffee-400': open, 'text-coffee-700 dark:text-coffee-300': !open }">
                <div class="flex items-center">
                    <i class="fas fa-boxes mr-3 w-5 text-center group-hover:scale-110 transition-transform"></i>
                    Estoque
                </div>
                <i class="fas fa-chevron-down transform transition-transform duration-200" :class="{ 'rotate-180': open }"></i>
            </button>
            <div x-show="open" x-collapse class="ml-6 mt-1 space-y-1">
                <a href="{% url 'inventory:dashboard' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-chart-bar mr-2"></i>Dashboard
                </a>
                <a href="{% url 'inventory:product_list' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-coffee mr-2"></i>Produtos
                </a>
                <a href="{% url 'inventory:material_list' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-tools mr-2"></i>Materiais
                </a>
                <a href="{% url 'inventory:category_list' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-tags mr-2"></i>Categorias
                </a>
            </div>
        </div>

        <!-- Production -->
        <div x-data="{ open: activeMenu === 'production' }">
            <button @click="open = !open" 
                    class="group w-full flex items-center justify-between px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 hover:bg-coffee-100 dark:hover:bg-coffee-800"
                    :class="{ 'bg-coffee-50 dark:bg-coffee-900/20 text-coffee-700 dark:text-coffee-400': open, 'text-coffee-700 dark:text-coffee-300': !open }">
                <div class="flex items-center">
                    <i class="fas fa-industry mr-3 w-5 text-center group-hover:scale-110 transition-transform"></i>
                    Produção
                </div>
                <i class="fas fa-chevron-down transform transition-transform duration-200" :class="{ 'rotate-180': open }"></i>
            </button>
            <div x-show="open" x-collapse class="ml-6 mt-1 space-y-1">
                <a href="{% url 'production:dashboard' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-chart-line mr-2"></i>Dashboard
                </a>
                <a href="{% url 'production:production_order_list' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-clipboard-list mr-2"></i>Ordens de Produção
                </a>
                <a href="{% url 'production:recipe_list' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-recipe mr-2"></i>Receitas
                </a>
            </div>
        </div>

        <!-- Sales -->
        <div x-data="{ open: activeMenu === 'sales' }">
            <button @click="open = !open" 
                    class="group w-full flex items-center justify-between px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 hover:bg-coffee-100 dark:hover:bg-coffee-800"
                    :class="{ 'bg-coffee-50 dark:bg-coffee-900/20 text-coffee-700 dark:text-coffee-400': open, 'text-coffee-700 dark:text-coffee-300': !open }">
                <div class="flex items-center">
                    <i class="fas fa-shopping-cart mr-3 w-5 text-center group-hover:scale-110 transition-transform"></i>
                    Vendas
                </div>
                <i class="fas fa-chevron-down transform transition-transform duration-200" :class="{ 'rotate-180': open }"></i>
            </button>
            <div x-show="open" x-collapse class="ml-6 mt-1 space-y-1">
                <a href="{% url 'sales:dashboard' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-chart-pie mr-2"></i>Dashboard
                </a>
                <a href="{% url 'sales:sales_order_list' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-receipt mr-2"></i>Pedidos de Venda
                </a>
                <a href="{% url 'sales:customer_list' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-users mr-2"></i>Clientes
                </a>
            </div>
        </div>

        <!-- Financial -->
        <div x-data="{ open: activeMenu === 'financial' }">
            <button @click="open = !open" 
                    class="group w-full flex items-center justify-between px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 hover:bg-coffee-100 dark:hover:bg-coffee-800"
                    :class="{ 'bg-coffee-50 dark:bg-coffee-900/20 text-coffee-700 dark:text-coffee-400': open, 'text-coffee-700 dark:text-coffee-300': !open }">
                <div class="flex items-center">
                    <i class="fas fa-dollar-sign mr-3 w-5 text-center group-hover:scale-110 transition-transform"></i>
                    Financeiro
                </div>
                <i class="fas fa-chevron-down transform transition-transform duration-200" :class="{ 'rotate-180': open }"></i>
            </button>
            <div x-show="open" x-collapse class="ml-6 mt-1 space-y-1">
                <a href="{% url 'financial:dashboard' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-chart-area mr-2"></i>Dashboard
                </a>
                <a href="{% url 'financial:accounts_receivable' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-arrow-down mr-2 text-green-500"></i>Contas a Receber
                </a>
                <a href="{% url 'financial:accounts_payable' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-arrow-up mr-2 text-red-500"></i>Contas a Pagar
                </a>
                <a href="{% url 'financial:payroll' %}" 
                   class="block px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-wallet mr-2"></i>Folha de Pagamento
                </a>
            </div>
        </div>

        <!-- Suppliers -->
        <a href="{% url 'suppliers:list' %}" 
           class="group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 hover:bg-coffee-100 dark:hover:bg-coffee-800"
           :class="{ 'bg-coffee-50 dark:bg-coffee-900/20 text-coffee-700 dark:text-coffee-400 border-r-2 border-coffee-500': activeMenu === 'suppliers', 'text-coffee-700 dark:text-coffee-300': activeMenu !== 'suppliers' }">
            <i class="fas fa-truck mr-3 w-5 text-center group-hover:scale-110 transition-transform"></i>
            Fornecedores
        </a>

        <!-- Divider -->
        <hr class="my-4 border-coffee-200 dark:border-coffee-700">

        <!-- Reports Section -->
        <div class="px-3 py-2">
            <h3 class="text-xs font-semibold text-coffee-500 dark:text-coffee-400 uppercase tracking-wider mb-2">
                Relatórios
            </h3>
            <div class="space-y-1">
                <a href="#" class="group flex items-center px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-chart-bar mr-3 w-5 text-center group-hover:scale-110 transition-transform"></i>
                    Relatório de Vendas
                </a>
                <a href="#" class="group flex items-center px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-box mr-3 w-5 text-center group-hover:scale-110 transition-transform"></i>
                    Relatório de Estoque
                </a>
                <a href="#" class="group flex items-center px-3 py-2 text-sm text-coffee-600 dark:text-coffee-400 rounded-md hover:bg-coffee-50 dark:hover:bg-coffee-800 hover:text-coffee-900 dark:hover:text-white transition-all duration-200">
                    <i class="fas fa-money-bill-wave mr-3 w-5 text-center group-hover:scale-110 transition-transform"></i>
                    Relatório Financeiro
                </a>
            </div>
        </div>
    </div>

    <!-- Bottom Section -->
    <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-coffee-200 dark:border-coffee-700">
        <div class="flex items-center justify-between">
            <div class="text-xs text-coffee-500 dark:text-coffee-400">
                v1.0.0
            </div>
            <button @click="darkMode = !darkMode" 
                    class="p-2 text-coffee-400 hover:text-coffee-600 dark:hover:text-coffee-300 transition-colors rounded-md hover:bg-coffee-100 dark:hover:bg-coffee-800"
                    title="Alternar tema">
                <i class="fas fa-moon" x-show="!darkMode"></i>
                <i class="fas fa-sun" x-show="darkMode"></i>
            </button>
        </div>
    </div>
</nav>
